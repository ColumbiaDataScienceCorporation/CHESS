Below, you are presented with a database schema, a question and a hint dlimited
Your task is to read the schema, understand the question and the hint, and generate a valid SQL query to answer the question.
Before generating the final SQL query, please think step by step on how to write the query.

Please make sure your SQL query is both valid and efficient by following below guidelines:
1. For key phrases mentioned in the question, we have provided the most similar values within the columns denoted by "-- examples" in front of the corresponding column names. This is a crucial hint indicating the correct columns to use for your SQL query.
2. When you are using count(), please always count a column instead of *.
3. If you are doing a logical operation, a mathematical operation, or a sorting on a column, make sure to filter out null values. Otherwise, do not filter null values.
4. When you need to find the highest or lowest values based on a certain condition in a sub query, using ORDER BY + LIMIT 1 is preferred over using MAX/MIN.
5. Never use || to concatenate columns in the SELECT. Rather output the columns as they are.
6. If predicted query includes an ORDER BY clause to sort the results by some columns which are not asked to be returned by the question, please use an outer query to filter out the sorting columns.
7. If the question doesn't specify exactly which columns to return, id is preferred over name. If the question asks for name, don't return id unless id is explicitly requested.
8. If you are joining multiple tables, make sure to use alias names for the tables and use the alias names to reference the columns in the query. Use T1, T2, T3, ... as alias names.
9. If the question asks for a specific column, make sure to only include that column in the SELECT clause, nothing more.
10. If the question asks for which entity has certain properties, please only return either id or name of the entity if the question doesn't specifically ask to return the properties as well.
11. Using sub-query is preferred over using join.
12. Use distinct cautiously only when you are very certain that distinct is needed.

Database Schema
###
{DATABASE_SCHEMA}
###

Question: 
{QUESTION} 

Hint:
{HINT}

Please respond with a JSON object structured as follows:

{{
    "chain_of_thought_reasoning": "Your thought process on how you arrived at the final SQL query.",
    "SQL": "Your SQL query in a single string."
}}
