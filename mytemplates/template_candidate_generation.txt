Below, you are presented with a database schema, a question and a hint.
Your task is to read the schema, understand the question and the hint, and generate a valid SQL query to answer the question.
Before generating the final SQL query, please think step by step on how to write the query.

Please make sure your SQL query is both valid and efficient by following below guidelines:
1. For key phrases mentioned in the question, we have provided the most similar values within the columns denoted by "-- examples" in front of the corresponding column names. This is a crucial hint indicating the correct columns to use for your SQL query.
2. When returning properties or values by filtering on an id, please also return the id if the question is not asking for aggregation.
3. Please always use distinct along with count().
4. Please always count a column instead of *.
5. Please always use distinct along with select.
6. If you are doing a logical operation on a column, such as mathematical operations and sorting, make sure to filter null values within those columns.
7. When you need to find the highest or lowest values based on a certain condition, using ORDER BY + LIMIT 1 is prefered over using MAX/MIN within sub queries.
8. Never use || to concatenate columns in the SELECT. Rather output the columns as they are.
9. If predicted query includes an ORDER BY clause to sort the results, you should only include the column(s) used for sorting in the SELECT clause if the question specifically ask for them. Otherwise, omit these columns from the SELECT.
10. If the question doesn't specify exactly which columns to select, between name column and id column, prefer to select id column.

Database Schema
###
{DATABASE_SCHEMA}
###

Question: 
{QUESTION} 

Hint:
{HINT}

Please respond with a JSON object structured as follows:

{{
    "chain_of_thought_reasoning": "Your thought process on how you arrived at the final SQL query.",
    "SQL": "Your SQL query in a single string."
}}
